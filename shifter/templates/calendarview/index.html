<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Shifter - Calendar View</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='calendarview/style.css') }}">
        <script src="{{ url_for('static', filename='calendarview/calendarAuth.js') }}"></script>
        <script src="{{ url_for('static', filename='calendarview/calendar.js') }}"></script>
        <script src="{{ url_for('static', filename='calendarview/shifts.js') }}"></script>
    </head>
    <body>
        <header>
            <h1>Shifter</h1>
            <p>Hello, {{ username }}</p>
            <form action="http://127.0.0.1:5000/auth/logout" method="get">
                <input type="submit" value="Logout" />
            </form>
        </header>
        <section class="content">
            <div class="config-values">config</div>
            <div class="calendar-wrapper">
                <div class="calendar">
                    <!-- User tried to connect a calendar and it failed (usually because they denied consent) -->
                    {% if denied != None %}
                    <div id="connect-btns-wrapper" class="connect-btns-wrapper" style="display:none;">
                        <button class="calendar-connect-btn google" type="button" onclick="connectToGoogle()">Connect To Google Calendar</button>
                        <button class="calendar-connect-btn outlook" type="button">Connect To Outlook Calendar</button>
                    </div>
                    <span id="error" onclick="dismissErrMsg()">Could not connect to calendar. Click to dismiss.</span>
                    <!-- Display user's Google calendar -->
                    {% elif calendar == "Google" %}
                    <script>googleListEvents(startOfMonth(), endOfMonth());</script>
                    {% else %}
                    <!-- User has no calendar, so these buttons are links to connect to supported calendars -->
                    <div class="connect-btns-wrapper">
                        <button class="calendar-connect-btn google" type="button" onclick="connectToGoogle()">Connect To Google Calendar</button>
                        <button class="calendar-connect-btn outlook" type="button">Connect To Outlook Calendar</button>
                    </div>
                    {% endif %}
                </div>
            </div>
            <div class="shift-config">
                <div id="select-shift-view">
                    <button class="create-shift-btn" onclick="showCreateShiftView()">+ Create shift</button>
                    <select title="Select a shift" name="shift" id="shifts-dropdown-list" class="shifts-dropdown-list">
                        <script>getShifts()</script>
                    </select>
                </div>
                <div id="create-shift-view">
                    <form id="create-shift-form">
                        <label for="name">*Shift name:</label>
                        <input type="text" name="name" id="name" required>

                        <label for="start-time">*Start time:</label>
                        <input type="time" name="start-time" id="start-time" required>
                        
                        <label for="end-time">End time:</label>
                        <input type="time" name="end-time" id="end-time">
                        
                        <input type="submit" value="Create" />
                    </form><script>document.getElementById("create-shift-form").addEventListener("submit", createShift)</script>
                    <button class="create-shift-go-back-btn" type="button" onclick="hideCreateShiftView()">Go back</button>
                    <div id="create-shift-status">
                        <span class="loading">Creating...</span>
                        <span class="error">Couldn't create the Shift</span>
                    </div>
                </div>
            </div>
        </section>
    </body>
</html>